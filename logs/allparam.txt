[I 2024-03-15 15:51:46,507] A new study created in memory with name: no-name-e9b11cc4-a5d4-4760-a21a-6d33d53c035d
-----biginning training-----
Namespace(epochs=1000, learning_rate=0.0010557325466324693, weight_decay=0.00022279817575779261, patience=20, seed=42, batch_size=64, output_dir='./AddViT', model_path='./VisionTransformer/vit.pt')
calculating mean and std...
loading dataset...
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 1, Training loss: 4.5875, Validation loss: 4.4884, Validation Accuracy: 0.0239
  0%|          | 1/1000 [01:56<32:20:53, 116.57s/it]Epoch 2, Training loss: 4.4750, Validation loss: 4.4252, Validation Accuracy: 0.0309
  0%|          | 2/1000 [03:54<32:36:52, 117.65s/it]Epoch 3, Training loss: 4.4699, Validation loss: 4.4449, Validation Accuracy: 0.0284
  0%|          | 3/1000 [05:52<32:36:39, 117.75s/it]Epoch 4, Training loss: 4.5387, Validation loss: 4.5724, Validation Accuracy: 0.0196
  0%|          | 4/1000 [07:50<32:34:39, 117.75s/it]Epoch 5, Training loss: 4.5550, Validation loss: 4.5556, Validation Accuracy: 0.0169
  0%|          | 5/1000 [09:48<32:32:26, 117.73s/it]Epoch 6, Training loss: 4.5509, Validation loss: 4.5505, Validation Accuracy: 0.0159
  1%|          | 6/1000 [11:46<32:30:15, 117.72s/it]Epoch 7, Training loss: 4.5457, Validation loss: 4.5301, Validation Accuracy: 0.0225
  1%|          | 7/1000 [13:43<32:28:13, 117.72s/it]Epoch 8, Training loss: 4.5401, Validation loss: 4.5700, Validation Accuracy: 0.0193
  1%|          | 8/1000 [15:41<32:24:34, 117.62s/it]Epoch 9, Training loss: 4.5416, Validation loss: 4.5271, Validation Accuracy: 0.0232
  1%|          | 9/1000 [17:38<32:20:55, 117.51s/it]Epoch 10, Training loss: 4.5447, Validation loss: 4.6073, Validation Accuracy: 0.0152
  1%|          | 10/1000 [19:35<32:18:24, 117.48s/it]Epoch 11, Training loss: 4.5590, Validation loss: 4.6021, Validation Accuracy: 0.0139
  1%|          | 11/1000 [21:33<32:15:51, 117.44s/it]Epoch 12, Training loss: 4.5699, Validation loss: 4.5538, Validation Accuracy: 0.0195
  1%|          | 12/1000 [23:30<32:12:33, 117.36s/it]Epoch 13, Training loss: 4.5453, Validation loss: 4.5497, Validation Accuracy: 0.0166
  1%|▏         | 13/1000 [25:27<32:09:13, 117.28s/it]Epoch 14, Training loss: 4.5849, Validation loss: 4.5883, Validation Accuracy: 0.0143
  1%|▏         | 14/1000 [27:24<32:06:46, 117.25s/it]Epoch 15, Training loss: 4.5656, Validation loss: 4.5500, Validation Accuracy: 0.0168
  2%|▏         | 15/1000 [29:21<32:03:50, 117.19s/it]Epoch 16, Training loss: 4.5561, Validation loss: 4.5672, Validation Accuracy: 0.0178
  2%|▏         | 16/1000 [31:18<31:59:52, 117.07s/it]Epoch 17, Training loss: 4.5660, Validation loss: 4.5731, Validation Accuracy: 0.0166
  2%|▏         | 17/1000 [33:15<31:56:22, 116.97s/it]Epoch 18, Training loss: 4.5600, Validation loss: 4.5894, Validation Accuracy: 0.0141
  2%|▏         | 18/1000 [35:12<31:53:42, 116.93s/it]Epoch 19, Training loss: 4.5756, Validation loss: 4.5653, Validation Accuracy: 0.0172
  2%|▏         | 19/1000 [37:08<31:51:25, 116.91s/it]Epoch 20, Training loss: 4.5508, Validation loss: 4.5730, Validation Accuracy: 0.0172
  2%|▏         | 20/1000 [39:05<31:48:14, 116.83s/it]Epoch 21, Training loss: 4.5575, Validation loss: 4.5715, Validation Accuracy: 0.0167
  2%|▏         | 21/1000 [41:01<31:44:32, 116.72s/it]Epoch 22, Training loss: 4.5794, Validation loss: 4.5912, Validation Accuracy: 0.0126
  2%|▏         | 21/1000 [42:58<33:23:31, 122.79s/it]
[I 2024-03-15 16:34:46,146] Trial 0 finished with value: 4.425210600445984 and parameters: {'learning_rate': 0.0010557325466324693, 'weight_decay': 0.00022279817575779261}. Best is trial 0 with value: 4.425210600445984.
Early stopping due to validation loss not improving for 20 epochs
Namespace(epochs=1000, learning_rate=2.100005732309447e-05, weight_decay=4.120128539938435e-06, patience=20, seed=42, batch_size=64, output_dir='./AddViT', model_path='./VisionTransformer/vit.pt')
calculating mean and std...
loading dataset...
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 1, Training loss: 3.5896, Validation loss: 3.4827, Validation Accuracy: 0.1736
  0%|          | 1/1000 [01:58<32:46:32, 118.11s/it]Epoch 2, Training loss: 3.2133, Validation loss: 3.3254, Validation Accuracy: 0.1974
  0%|          | 2/1000 [03:57<32:52:18, 118.58s/it]Epoch 3, Training loss: 2.9783, Validation loss: 3.2249, Validation Accuracy: 0.2151
  0%|          | 3/1000 [05:55<32:52:33, 118.71s/it]Epoch 4, Training loss: 2.7604, Validation loss: 3.2108, Validation Accuracy: 0.2303
  0%|          | 4/1000 [07:54<32:52:01, 118.80s/it]Epoch 5, Training loss: 2.5247, Validation loss: 3.1278, Validation Accuracy: 0.2404
  0%|          | 5/1000 [09:53<32:50:18, 118.81s/it]Epoch 6, Training loss: 2.2397, Validation loss: 3.1882, Validation Accuracy: 0.2357
  1%|          | 6/1000 [11:51<32:43:58, 118.55s/it]Epoch 7, Training loss: 1.8963, Validation loss: 3.3320, Validation Accuracy: 0.2325
  1%|          | 7/1000 [13:49<32:39:22, 118.39s/it]Epoch 8, Training loss: 1.4692, Validation loss: 3.4511, Validation Accuracy: 0.2304
  1%|          | 8/1000 [15:47<32:36:08, 118.31s/it]Epoch 9, Training loss: 1.0185, Validation loss: 3.6633, Validation Accuracy: 0.2249
  1%|          | 9/1000 [17:46<32:33:34, 118.28s/it]Epoch 10, Training loss: 0.6060, Validation loss: 3.9064, Validation Accuracy: 0.2222
  1%|          | 10/1000 [19:44<32:30:29, 118.21s/it]Epoch 11, Training loss: 0.3183, Validation loss: 4.1503, Validation Accuracy: 0.2151
  1%|          | 11/1000 [21:42<32:27:24, 118.14s/it]Epoch 12, Training loss: 0.1680, Validation loss: 4.3226, Validation Accuracy: 0.2227
  1%|          | 12/1000 [23:40<32:24:48, 118.11s/it]Epoch 13, Training loss: 0.2017, Validation loss: 4.5539, Validation Accuracy: 0.1927
  1%|▏         | 13/1000 [25:38<32:22:52, 118.11s/it]Epoch 14, Training loss: 0.3107, Validation loss: 4.6367, Validation Accuracy: 0.2107
  1%|▏         | 14/1000 [27:36<32:21:01, 118.12s/it]Epoch 15, Training loss: 0.0640, Validation loss: 4.6777, Validation Accuracy: 0.2255
  2%|▏         | 15/1000 [29:34<32:19:07, 118.12s/it]Epoch 16, Training loss: 0.0277, Validation loss: 4.7703, Validation Accuracy: 0.2303
  2%|▏         | 16/1000 [31:32<32:16:57, 118.11s/it]Epoch 17, Training loss: 0.3119, Validation loss: 4.8108, Validation Accuracy: 0.2013
  2%|▏         | 17/1000 [33:30<32:14:59, 118.11s/it]Epoch 18, Training loss: 0.2277, Validation loss: 4.9088, Validation Accuracy: 0.2180
  2%|▏         | 18/1000 [35:28<32:13:24, 118.13s/it]Epoch 19, Training loss: 0.0303, Validation loss: 4.9149, Validation Accuracy: 0.2357
  2%|▏         | 19/1000 [37:27<32:11:24, 118.13s/it]Epoch 20, Training loss: 0.0069, Validation loss: 4.9232, Validation Accuracy: 0.2424
  2%|▏         | 20/1000 [39:25<32:09:08, 118.11s/it]Epoch 21, Training loss: 0.0911, Validation loss: 5.2304, Validation Accuracy: 0.1716
  2%|▏         | 21/1000 [41:23<32:06:24, 118.06s/it]Epoch 22, Training loss: 0.4012, Validation loss: 5.0860, Validation Accuracy: 0.2110
  2%|▏         | 22/1000 [43:21<32:04:07, 118.04s/it]Epoch 23, Training loss: 0.0336, Validation loss: 5.0715, Validation Accuracy: 0.2257
  2%|▏         | 23/1000 [45:19<32:01:56, 118.03s/it]Epoch 24, Training loss: 0.0090, Validation loss: 5.0921, Validation Accuracy: 0.2399
  2%|▏         | 24/1000 [47:17<32:00:07, 118.04s/it]Epoch 25, Training loss: 0.0091, Validation loss: 5.2130, Validation Accuracy: 0.2250
  2%|▏         | 24/1000 [49:15<33:23:01, 123.14s/it]
[I 2024-03-15 17:24:02,312] Trial 1 finished with value: 3.1278475075011043 and parameters: {'learning_rate': 2.100005732309447e-05, 'weight_decay': 4.120128539938435e-06}. Best is trial 1 with value: 3.1278475075011043.
Early stopping due to validation loss not improving for 20 epochs
Namespace(epochs=1000, learning_rate=0.027669881457930735, weight_decay=3.726474147624754e-05, patience=20, seed=42, batch_size=64, output_dir='./AddViT', model_path='./VisionTransformer/vit.pt')
calculating mean and std...
loading dataset...
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 1, Training loss: 5.5323, Validation loss: 4.7373, Validation Accuracy: 0.0103
  0%|          | 1/1000 [01:56<32:27:23, 116.96s/it]Epoch 2, Training loss: 4.6677, Validation loss: 4.6258, Validation Accuracy: 0.0152
  0%|          | 2/1000 [03:54<32:32:36, 117.39s/it]Epoch 3, Training loss: 4.6379, Validation loss: 4.6198, Validation Accuracy: 0.0149
  0%|          | 3/1000 [05:52<32:32:43, 117.52s/it]Epoch 4, Training loss: 4.6281, Validation loss: 4.6074, Validation Accuracy: 0.0182
  0%|          | 4/1000 [07:49<32:31:12, 117.54s/it]Epoch 5, Training loss: 4.6318, Validation loss: 4.6001, Validation Accuracy: 0.0200
  0%|          | 5/1000 [09:47<32:29:29, 117.56s/it]Epoch 6, Training loss: 4.6435, Validation loss: 4.6712, Validation Accuracy: 0.0140
  1%|          | 6/1000 [11:43<32:20:37, 117.14s/it]Epoch 7, Training loss: 4.6651, Validation loss: 4.7799, Validation Accuracy: 0.0188
  1%|          | 7/1000 [13:40<32:14:34, 116.89s/it]Epoch 8, Training loss: 4.6877, Validation loss: 4.6786, Validation Accuracy: 0.0169
  1%|          | 8/1000 [15:36<32:09:40, 116.71s/it]Epoch 9, Training loss: 4.6852, Validation loss: 4.6449, Validation Accuracy: 0.0210
  1%|          | 9/1000 [17:32<32:05:09, 116.56s/it]Epoch 10, Training loss: 4.6445, Validation loss: 4.6775, Validation Accuracy: 0.0185
  1%|          | 10/1000 [19:29<32:01:42, 116.47s/it]Epoch 11, Training loss: 4.6538, Validation loss: 4.6487, Validation Accuracy: 0.0188
  1%|          | 11/1000 [21:25<31:57:49, 116.35s/it]Epoch 12, Training loss: 4.6443, Validation loss: 4.6420, Validation Accuracy: 0.0148
  1%|          | 12/1000 [23:21<31:53:52, 116.23s/it]Epoch 13, Training loss: 4.6517, Validation loss: 4.6695, Validation Accuracy: 0.0183
  1%|▏         | 13/1000 [25:17<31:51:00, 116.17s/it]Epoch 14, Training loss: 4.6594, Validation loss: 4.6489, Validation Accuracy: 0.0169
  1%|▏         | 14/1000 [27:13<31:48:55, 116.16s/it]Epoch 15, Training loss: 4.6535, Validation loss: 4.6562, Validation Accuracy: 0.0205
  2%|▏         | 15/1000 [29:09<31:46:36, 116.14s/it]Epoch 16, Training loss: 4.6973, Validation loss: 4.8062, Validation Accuracy: 0.0151
  2%|▏         | 16/1000 [31:05<31:43:25, 116.06s/it]Epoch 17, Training loss: 4.6646, Validation loss: 4.6815, Validation Accuracy: 0.0224
  2%|▏         | 17/1000 [33:01<31:41:02, 116.03s/it]Epoch 18, Training loss: 4.6232, Validation loss: 4.6023, Validation Accuracy: 0.0283
  2%|▏         | 18/1000 [34:56<31:37:59, 115.97s/it]Epoch 19, Training loss: 4.6185, Validation loss: 4.6305, Validation Accuracy: 0.0207
  2%|▏         | 19/1000 [36:52<31:34:10, 115.85s/it]Epoch 20, Training loss: 4.6050, Validation loss: 4.6799, Validation Accuracy: 0.0244
  2%|▏         | 20/1000 [38:48<31:30:49, 115.77s/it]Epoch 21, Training loss: 4.6046, Validation loss: 4.6240, Validation Accuracy: 0.0231
  2%|▏         | 21/1000 [40:43<31:28:30, 115.74s/it]Epoch 22, Training loss: 4.6133, Validation loss: 4.6458, Validation Accuracy: 0.0232
  2%|▏         | 22/1000 [42:39<31:26:05, 115.71s/it]Epoch 23, Training loss: 4.6063, Validation loss: 4.5580, Validation Accuracy: 0.0256
  2%|▏         | 23/1000 [44:35<31:27:40, 115.93s/it]Epoch 24, Training loss: 4.5894, Validation loss: 4.5789, Validation Accuracy: 0.0224
  2%|▏         | 24/1000 [46:31<31:24:55, 115.88s/it]Epoch 25, Training loss: 4.5810, Validation loss: 4.6351, Validation Accuracy: 0.0260
  2%|▎         | 25/1000 [48:27<31:23:14, 115.89s/it]Epoch 26, Training loss: 4.5914, Validation loss: 4.6670, Validation Accuracy: 0.0256
  3%|▎         | 26/1000 [50:23<31:20:55, 115.87s/it]Epoch 27, Training loss: 4.5740, Validation loss: 4.5275, Validation Accuracy: 0.0301
  3%|▎         | 27/1000 [52:19<31:22:24, 116.08s/it]Epoch 28, Training loss: 4.5930, Validation loss: 4.6127, Validation Accuracy: 0.0270
  3%|▎         | 28/1000 [54:15<31:19:17, 116.01s/it]Epoch 29, Training loss: 4.5982, Validation loss: 4.6343, Validation Accuracy: 0.0259
  3%|▎         | 29/1000 [56:11<31:15:46, 115.91s/it]Epoch 30, Training loss: 4.6001, Validation loss: 4.6178, Validation Accuracy: 0.0210
  3%|▎         | 30/1000 [58:07<31:12:23, 115.82s/it]Epoch 31, Training loss: 4.6404, Validation loss: 4.6068, Validation Accuracy: 0.0204
  3%|▎         | 31/1000 [1:00:02<31:09:03, 115.73s/it]Epoch 32, Training loss: 4.6060, Validation loss: 4.6244, Validation Accuracy: 0.0239
  3%|▎         | 32/1000 [1:01:58<31:06:28, 115.69s/it]Epoch 33, Training loss: 4.5956, Validation loss: 4.6102, Validation Accuracy: 0.0234
  3%|▎         | 33/1000 [1:03:53<31:04:23, 115.68s/it]Epoch 34, Training loss: 4.5867, Validation loss: 4.5104, Validation Accuracy: 0.0281
  3%|▎         | 34/1000 [1:05:50<31:06:04, 115.91s/it]Epoch 35, Training loss: 4.5815, Validation loss: 4.5758, Validation Accuracy: 0.0259
  4%|▎         | 35/1000 [1:07:45<31:02:29, 115.80s/it]Epoch 36, Training loss: 4.5966, Validation loss: 4.5587, Validation Accuracy: 0.0284
  4%|▎         | 36/1000 [1:09:41<30:58:43, 115.69s/it]Epoch 37, Training loss: 4.5876, Validation loss: 4.5466, Validation Accuracy: 0.0233
  4%|▎         | 37/1000 [1:11:36<30:56:09, 115.65s/it]Epoch 38, Training loss: 4.5640, Validation loss: 4.5160, Validation Accuracy: 0.0313
  4%|▍         | 38/1000 [1:13:32<30:53:43, 115.62s/it]Epoch 39, Training loss: 4.5558, Validation loss: 4.5728, Validation Accuracy: 0.0279
  4%|▍         | 39/1000 [1:15:27<30:50:57, 115.56s/it]Epoch 40, Training loss: 4.5698, Validation loss: 4.6069, Validation Accuracy: 0.0275
  4%|▍         | 40/1000 [1:17:23<30:48:28, 115.53s/it]Epoch 41, Training loss: 4.5627, Validation loss: 4.6345, Validation Accuracy: 0.0269
  4%|▍         | 41/1000 [1:19:18<30:46:09, 115.51s/it]Epoch 42, Training loss: 4.5483, Validation loss: 4.5580, Validation Accuracy: 0.0266
  4%|▍         | 42/1000 [1:21:14<30:43:57, 115.49s/it]Epoch 43, Training loss: 4.5373, Validation loss: 4.5121, Validation Accuracy: 0.0343
  4%|▍         | 43/1000 [1:23:09<30:40:42, 115.41s/it]Epoch 44, Training loss: 4.5654, Validation loss: 4.5431, Validation Accuracy: 0.0266
  4%|▍         | 44/1000 [1:25:04<30:37:47, 115.34s/it]Epoch 45, Training loss: 4.5526, Validation loss: 4.5187, Validation Accuracy: 0.0299
  4%|▍         | 45/1000 [1:26:59<30:35:12, 115.30s/it]Epoch 46, Training loss: 4.5677, Validation loss: 4.6574, Validation Accuracy: 0.0233
  5%|▍         | 46/1000 [1:28:55<30:33:56, 115.34s/it]Epoch 47, Training loss: 4.6556, Validation loss: 4.6999, Validation Accuracy: 0.0192
  5%|▍         | 47/1000 [1:30:50<30:32:54, 115.40s/it]Epoch 48, Training loss: 4.6357, Validation loss: 4.6219, Validation Accuracy: 0.0239
  5%|▍         | 48/1000 [1:32:46<30:31:31, 115.43s/it]Epoch 49, Training loss: 4.6088, Validation loss: 4.6310, Validation Accuracy: 0.0199
  5%|▍         | 49/1000 [1:34:41<30:29:48, 115.45s/it]Epoch 50, Training loss: 4.6183, Validation loss: 4.6382, Validation Accuracy: 0.0224
  5%|▌         | 50/1000 [1:36:37<30:28:13, 115.47s/it]Epoch 51, Training loss: 4.6814, Validation loss: 4.6995, Validation Accuracy: 0.0151
  5%|▌         | 51/1000 [1:38:32<30:26:32, 115.48s/it]Epoch 52, Training loss: 4.6403, Validation loss: 4.6896, Validation Accuracy: 0.0235
  5%|▌         | 52/1000 [1:40:28<30:24:24, 115.47s/it]Epoch 53, Training loss: 4.6228, Validation loss: 4.6633, Validation Accuracy: 0.0194
  5%|▌         | 53/1000 [1:42:23<30:21:52, 115.43s/it]Epoch 54, Training loss: 4.6374, Validation loss: 4.6551, Validation Accuracy: 0.0259
  5%|▌         | 53/1000 [1:44:18<31:03:53, 118.09s/it]
[I 2024-03-15 19:08:22,025] Trial 2 finished with value: 4.51035522351599 and parameters: {'learning_rate': 0.027669881457930735, 'weight_decay': 3.726474147624754e-05}. Best is trial 1 with value: 3.1278475075011043.
Early stopping due to validation loss not improving for 20 epochs
Namespace(epochs=1000, learning_rate=0.0007281039486062567, weight_decay=1.4341098351069263e-05, patience=20, seed=42, batch_size=64, output_dir='./AddViT', model_path='./VisionTransformer/vit.pt')
calculating mean and std...
loading dataset...
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 1, Training loss: 4.5114, Validation loss: 4.4257, Validation Accuracy: 0.0279
  0%|          | 1/1000 [01:57<32:39:02, 117.66s/it]Epoch 2, Training loss: 4.3859, Validation loss: 4.3527, Validation Accuracy: 0.0411
  0%|          | 2/1000 [03:56<32:44:33, 118.11s/it]Epoch 3, Training loss: 4.3566, Validation loss: 4.3971, Validation Accuracy: 0.0387
  0%|          | 3/1000 [05:53<32:39:21, 117.92s/it]Epoch 4, Training loss: 4.3793, Validation loss: 4.4028, Validation Accuracy: 0.0397
  0%|          | 4/1000 [07:51<32:36:44, 117.88s/it]Epoch 5, Training loss: 4.3901, Validation loss: 4.3467, Validation Accuracy: 0.0426
  0%|          | 5/1000 [09:50<32:40:21, 118.21s/it]Epoch 6, Training loss: 4.3107, Validation loss: 4.3054, Validation Accuracy: 0.0487
  1%|          | 6/1000 [11:49<32:40:41, 118.35s/it]Epoch 7, Training loss: 4.3279, Validation loss: 4.3416, Validation Accuracy: 0.0422
  1%|          | 7/1000 [13:46<32:35:51, 118.18s/it]Epoch 8, Training loss: 4.3284, Validation loss: 4.3074, Validation Accuracy: 0.0449
  1%|          | 8/1000 [15:44<32:32:22, 118.09s/it]Epoch 9, Training loss: 4.3012, Validation loss: 4.3033, Validation Accuracy: 0.0511
  1%|          | 9/1000 [17:43<32:33:41, 118.29s/it]Epoch 10, Training loss: 4.2711, Validation loss: 4.2469, Validation Accuracy: 0.0517
  1%|          | 10/1000 [19:41<32:32:42, 118.35s/it]Epoch 11, Training loss: 4.2439, Validation loss: 4.2324, Validation Accuracy: 0.0554
  1%|          | 11/1000 [21:40<32:31:00, 118.36s/it]Epoch 12, Training loss: 4.2721, Validation loss: 4.2806, Validation Accuracy: 0.0514
  1%|          | 12/1000 [23:37<32:25:20, 118.14s/it]Epoch 13, Training loss: 4.2273, Validation loss: 4.2845, Validation Accuracy: 0.0510
  1%|▏         | 13/1000 [25:35<32:21:11, 118.01s/it]Epoch 14, Training loss: 4.2083, Validation loss: 4.2325, Validation Accuracy: 0.0558
  1%|▏         | 14/1000 [27:33<32:17:54, 117.93s/it]Epoch 15, Training loss: 4.2112, Validation loss: 4.2181, Validation Accuracy: 0.0582
  2%|▏         | 15/1000 [29:32<32:19:21, 118.13s/it]Epoch 16, Training loss: 4.1901, Validation loss: 4.2018, Validation Accuracy: 0.0611
  2%|▏         | 16/1000 [31:30<32:19:28, 118.26s/it]Epoch 17, Training loss: 4.1855, Validation loss: 4.2081, Validation Accuracy: 0.0616
  2%|▏         | 17/1000 [33:28<32:15:02, 118.11s/it]Epoch 18, Training loss: 4.1626, Validation loss: 4.2210, Validation Accuracy: 0.0588
  2%|▏         | 18/1000 [35:26<32:11:06, 117.99s/it]Epoch 19, Training loss: 4.2129, Validation loss: 4.2555, Validation Accuracy: 0.0561
  2%|▏         | 19/1000 [37:23<32:07:26, 117.89s/it]Epoch 20, Training loss: 4.2275, Validation loss: 4.2396, Validation Accuracy: 0.0579
  2%|▏         | 20/1000 [39:21<32:04:02, 117.80s/it]Epoch 21, Training loss: 4.1743, Validation loss: 4.2087, Validation Accuracy: 0.0625
  2%|▏         | 21/1000 [41:18<32:00:04, 117.68s/it]Epoch 22, Training loss: 4.1692, Validation loss: 4.2615, Validation Accuracy: 0.0524
  2%|▏         | 22/1000 [43:15<31:56:20, 117.57s/it]Epoch 23, Training loss: 4.1696, Validation loss: 4.1734, Validation Accuracy: 0.0668
  2%|▏         | 23/1000 [45:14<31:57:09, 117.74s/it]Epoch 24, Training loss: 4.1637, Validation loss: 4.1938, Validation Accuracy: 0.0649
  2%|▏         | 24/1000 [47:11<31:53:06, 117.61s/it]Epoch 25, Training loss: 4.1372, Validation loss: 4.2148, Validation Accuracy: 0.0620
  2%|▎         | 25/1000 [49:08<31:50:04, 117.54s/it]Epoch 26, Training loss: 4.1453, Validation loss: 4.1650, Validation Accuracy: 0.0686
  3%|▎         | 26/1000 [51:07<31:51:16, 117.74s/it]Epoch 27, Training loss: 4.1496, Validation loss: 4.2549, Validation Accuracy: 0.0535
  3%|▎         | 27/1000 [53:04<31:47:51, 117.65s/it]Epoch 28, Training loss: 4.2268, Validation loss: 4.2606, Validation Accuracy: 0.0547
  3%|▎         | 28/1000 [55:01<31:45:20, 117.61s/it]Epoch 29, Training loss: 4.1803, Validation loss: 4.2080, Validation Accuracy: 0.0651
  3%|▎         | 29/1000 [56:59<31:42:06, 117.54s/it]Epoch 30, Training loss: 4.1478, Validation loss: 4.2000, Validation Accuracy: 0.0644
  3%|▎         | 30/1000 [58:56<31:38:52, 117.46s/it]Epoch 31, Training loss: 4.1268, Validation loss: 4.1636, Validation Accuracy: 0.0676
  3%|▎         | 31/1000 [1:00:54<31:39:49, 117.64s/it]Epoch 32, Training loss: 4.1584, Validation loss: 4.2013, Validation Accuracy: 0.0634
  3%|▎         | 32/1000 [1:02:51<31:36:08, 117.53s/it]Epoch 33, Training loss: 4.1523, Validation loss: 4.1847, Validation Accuracy: 0.0638
  3%|▎         | 33/1000 [1:04:49<31:31:59, 117.39s/it]Epoch 34, Training loss: 4.1675, Validation loss: 4.1962, Validation Accuracy: 0.0653
  3%|▎         | 34/1000 [1:06:46<31:28:33, 117.30s/it]Epoch 35, Training loss: 4.1460, Validation loss: 4.1541, Validation Accuracy: 0.0683
  4%|▎         | 35/1000 [1:08:44<31:29:43, 117.50s/it]Epoch 36, Training loss: 4.1241, Validation loss: 4.2065, Validation Accuracy: 0.0645
  4%|▎         | 36/1000 [1:10:41<31:26:07, 117.39s/it]Epoch 37, Training loss: 4.1111, Validation loss: 4.1563, Validation Accuracy: 0.0722
  4%|▎         | 37/1000 [1:12:38<31:23:31, 117.35s/it]Epoch 38, Training loss: 4.1182, Validation loss: 4.1909, Validation Accuracy: 0.0677
  4%|▍         | 38/1000 [1:14:35<31:21:03, 117.32s/it]Epoch 39, Training loss: 4.0943, Validation loss: 4.1653, Validation Accuracy: 0.0684
  4%|▍         | 39/1000 [1:16:33<31:19:02, 117.32s/it]Epoch 40, Training loss: 4.0950, Validation loss: 4.1504, Validation Accuracy: 0.0710
  4%|▍         | 40/1000 [1:18:31<31:20:47, 117.55s/it]Epoch 41, Training loss: 4.1162, Validation loss: 4.1818, Validation Accuracy: 0.0650
  4%|▍         | 41/1000 [1:20:28<31:17:24, 117.46s/it]Epoch 42, Training loss: 4.1116, Validation loss: 4.2503, Validation Accuracy: 0.0626
  4%|▍         | 42/1000 [1:22:25<31:13:17, 117.33s/it]Epoch 43, Training loss: 4.1207, Validation loss: 4.1832, Validation Accuracy: 0.0665
  4%|▍         | 43/1000 [1:24:22<31:09:32, 117.21s/it]Epoch 44, Training loss: 4.0963, Validation loss: 4.1692, Validation Accuracy: 0.0695
  4%|▍         | 44/1000 [1:26:19<31:06:30, 117.14s/it]Epoch 45, Training loss: 4.0724, Validation loss: 4.1617, Validation Accuracy: 0.0778
  4%|▍         | 45/1000 [1:28:16<31:03:54, 117.10s/it]Epoch 46, Training loss: 4.0693, Validation loss: 4.1506, Validation Accuracy: 0.0741
  5%|▍         | 46/1000 [1:30:13<31:01:31, 117.08s/it]Epoch 47, Training loss: 4.0636, Validation loss: 4.2035, Validation Accuracy: 0.0640
  5%|▍         | 47/1000 [1:32:10<30:58:59, 117.04s/it]Epoch 48, Training loss: 4.0430, Validation loss: 4.0942, Validation Accuracy: 0.0781
  5%|▍         | 48/1000 [1:34:08<31:00:52, 117.28s/it]Epoch 49, Training loss: 4.0400, Validation loss: 4.1635, Validation Accuracy: 0.0757
  5%|▍         | 49/1000 [1:36:05<30:57:20, 117.18s/it]Epoch 50, Training loss: 4.0644, Validation loss: 4.1377, Validation Accuracy: 0.0766
  5%|▌         | 50/1000 [1:38:02<30:54:46, 117.14s/it]Epoch 51, Training loss: 4.0987, Validation loss: 4.1360, Validation Accuracy: 0.0777
  5%|▌         | 51/1000 [1:39:59<30:52:23, 117.12s/it]Epoch 52, Training loss: 4.0763, Validation loss: 4.1534, Validation Accuracy: 0.0738
  5%|▌         | 52/1000 [1:41:56<30:50:07, 117.10s/it]Epoch 53, Training loss: 4.0580, Validation loss: 4.1512, Validation Accuracy: 0.0709
  5%|▌         | 53/1000 [1:43:53<30:46:58, 117.02s/it]Epoch 54, Training loss: 4.0747, Validation loss: 4.2251, Validation Accuracy: 0.0692
  5%|▌         | 54/1000 [1:45:49<30:44:25, 116.98s/it]Epoch 55, Training loss: 4.0533, Validation loss: 4.1619, Validation Accuracy: 0.0684
  6%|▌         | 55/1000 [1:47:46<30:42:29, 116.98s/it]Epoch 56, Training loss: 4.0766, Validation loss: 4.1736, Validation Accuracy: 0.0707
  6%|▌         | 56/1000 [1:49:44<30:41:26, 117.04s/it]Epoch 57, Training loss: 4.0435, Validation loss: 4.1581, Validation Accuracy: 0.0736
  6%|▌         | 57/1000 [1:51:41<30:40:01, 117.07s/it]Epoch 58, Training loss: 4.0860, Validation loss: 4.1758, Validation Accuracy: 0.0668
  6%|▌         | 58/1000 [1:53:38<30:37:39, 117.05s/it]Epoch 59, Training loss: 4.0997, Validation loss: 4.1564, Validation Accuracy: 0.0730
  6%|▌         | 59/1000 [1:55:35<30:35:11, 117.02s/it]Epoch 60, Training loss: 4.0448, Validation loss: 4.1274, Validation Accuracy: 0.0760
  6%|▌         | 60/1000 [1:57:32<30:33:05, 117.01s/it]Epoch 61, Training loss: 4.0301, Validation loss: 4.1126, Validation Accuracy: 0.0832
  6%|▌         | 61/1000 [1:59:29<30:31:10, 117.01s/it]Epoch 62, Training loss: 4.0142, Validation loss: 4.0977, Validation Accuracy: 0.0824
  6%|▌         | 62/1000 [2:01:26<30:29:00, 116.99s/it]Epoch 63, Training loss: 3.9855, Validation loss: 4.0554, Validation Accuracy: 0.0880
  6%|▋         | 63/1000 [2:03:23<30:30:26, 117.21s/it]Epoch 64, Training loss: 4.0272, Validation loss: 4.1295, Validation Accuracy: 0.0754
  6%|▋         | 64/1000 [2:05:20<30:25:58, 117.05s/it]Epoch 65, Training loss: 4.0409, Validation loss: 4.1204, Validation Accuracy: 0.0757
  6%|▋         | 65/1000 [2:07:17<30:22:31, 116.95s/it]Epoch 66, Training loss: 4.0292, Validation loss: 4.1011, Validation Accuracy: 0.0779
  7%|▋         | 66/1000 [2:09:14<30:19:43, 116.90s/it]Epoch 67, Training loss: 3.9992, Validation loss: 4.1162, Validation Accuracy: 0.0764
  7%|▋         | 67/1000 [2:11:10<30:17:14, 116.86s/it]Epoch 68, Training loss: 3.9912, Validation loss: 4.1082, Validation Accuracy: 0.0801
  7%|▋         | 68/1000 [2:13:07<30:15:12, 116.86s/it]Epoch 69, Training loss: 3.9963, Validation loss: 4.0971, Validation Accuracy: 0.0786
  7%|▋         | 69/1000 [2:15:04<30:13:03, 116.85s/it]Epoch 70, Training loss: 4.0313, Validation loss: 4.1676, Validation Accuracy: 0.0722
  7%|▋         | 70/1000 [2:17:01<30:11:28, 116.87s/it]Epoch 71, Training loss: 4.0727, Validation loss: 4.1445, Validation Accuracy: 0.0773
  7%|▋         | 71/1000 [2:18:58<30:09:22, 116.86s/it]Epoch 72, Training loss: 4.0573, Validation loss: 4.1510, Validation Accuracy: 0.0756
  7%|▋         | 72/1000 [2:20:55<30:07:43, 116.88s/it]Epoch 73, Training loss: 4.0335, Validation loss: 4.1406, Validation Accuracy: 0.0738
  7%|▋         | 73/1000 [2:22:52<30:06:33, 116.93s/it]Epoch 74, Training loss: 4.0251, Validation loss: 4.1632, Validation Accuracy: 0.0717
  7%|▋         | 74/1000 [2:24:49<30:05:27, 116.98s/it]Epoch 75, Training loss: 4.0349, Validation loss: 4.1438, Validation Accuracy: 0.0745
  8%|▊         | 75/1000 [2:26:46<30:03:41, 117.00s/it]Epoch 76, Training loss: 4.0379, Validation loss: 4.1482, Validation Accuracy: 0.0703
  8%|▊         | 76/1000 [2:28:43<30:01:35, 116.99s/it]Epoch 77, Training loss: 4.0365, Validation loss: 4.1748, Validation Accuracy: 0.0716
  8%|▊         | 77/1000 [2:30:40<29:59:06, 116.95s/it]Epoch 78, Training loss: 4.0542, Validation loss: 4.1687, Validation Accuracy: 0.0658
  8%|▊         | 78/1000 [2:32:37<29:56:27, 116.91s/it]Epoch 79, Training loss: 4.0885, Validation loss: 4.2090, Validation Accuracy: 0.0608
  8%|▊         | 79/1000 [2:34:33<29:54:30, 116.91s/it]Epoch 80, Training loss: 4.0629, Validation loss: 4.1775, Validation Accuracy: 0.0710
  8%|▊         | 80/1000 [2:36:30<29:52:56, 116.93s/it]Epoch 81, Training loss: 4.0815, Validation loss: 4.1664, Validation Accuracy: 0.0708
  8%|▊         | 81/1000 [2:38:28<29:51:57, 116.99s/it]Epoch 82, Training loss: 4.0736, Validation loss: 4.1641, Validation Accuracy: 0.0646
  8%|▊         | 82/1000 [2:40:25<29:50:43, 117.04s/it]Epoch 83, Training loss: 4.0520, Validation loss: 4.1649, Validation Accuracy: 0.0737
  8%|▊         | 82/1000 [2:42:22<30:17:45, 118.81s/it]
[I 2024-03-15 21:50:45,141] Trial 3 finished with value: 4.055416810284754 and parameters: {'learning_rate': 0.0007281039486062567, 'weight_decay': 1.4341098351069263e-05}. Best is trial 1 with value: 3.1278475075011043.
Early stopping due to validation loss not improving for 20 epochs
Namespace(epochs=1000, learning_rate=1.5199035244619409e-05, weight_decay=4.1710402064016316e-05, patience=20, seed=42, batch_size=64, output_dir='./AddViT', model_path='./VisionTransformer/vit.pt')
calculating mean and std...
loading dataset...
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch 1, Training loss: 3.3704, Validation loss: 3.4495, Validation Accuracy: 0.1828
  0%|          | 1/1000 [01:58<32:50:28, 118.35s/it]Epoch 2, Training loss: 3.0764, Validation loss: 3.3424, Validation Accuracy: 0.1987
  0%|          | 2/1000 [03:57<32:54:18, 118.70s/it]Epoch 3, Training loss: 2.8824, Validation loss: 3.2810, Validation Accuracy: 0.2107
  0%|          | 3/1000 [05:56<32:54:25, 118.82s/it]Epoch 4, Training loss: 2.6879, Validation loss: 3.2695, Validation Accuracy: 0.2241
  0%|          | 4/1000 [07:55<32:53:34, 118.89s/it]Epoch 5, Training loss: 2.4683, Validation loss: 3.2446, Validation Accuracy: 0.2255
  0%|          | 5/1000 [09:54<32:51:47, 118.90s/it]Epoch 6, Training loss: 2.1925, Validation loss: 3.2987, Validation Accuracy: 0.2204
  1%|          | 6/1000 [11:52<32:45:37, 118.65s/it]Epoch 7, Training loss: 1.8671, Validation loss: 3.4900, Validation Accuracy: 0.2081
  1%|          | 7/1000 [13:50<32:40:56, 118.49s/it]Epoch 8, Training loss: 1.4810, Validation loss: 3.4916, Validation Accuracy: 0.2206
  1%|          | 8/1000 [15:48<32:37:07, 118.37s/it]Epoch 9, Training loss: 1.0790, Validation loss: 3.7027, Validation Accuracy: 0.2119
  1%|          | 9/1000 [17:46<32:33:59, 118.30s/it]Epoch 10, Training loss: 0.7058, Validation loss: 3.9486, Validation Accuracy: 0.2066
  1%|          | 10/1000 [19:45<32:31:42, 118.29s/it]Epoch 11, Training loss: 0.4172, Validation loss: 4.1271, Validation Accuracy: 0.2011
  1%|          | 11/1000 [21:43<32:29:20, 118.26s/it]Epoch 12, Training loss: 0.2388, Validation loss: 4.2669, Validation Accuracy: 0.2083
  1%|          | 12/1000 [23:41<32:27:38, 118.28s/it]Epoch 13, Training loss: 0.1700, Validation loss: 4.4684, Validation Accuracy: 0.1995
  1%|▏         | 13/1000 [25:39<32:25:38, 118.28s/it]Epoch 14, Training loss: 0.2998, Validation loss: 4.6898, Validation Accuracy: 0.1885
  1%|▏         | 14/1000 [27:37<32:23:12, 118.25s/it]Epoch 15, Training loss: 0.1213, Validation loss: 4.6461, Validation Accuracy: 0.2092
  2%|▏         | 15/1000 [29:36<32:20:16, 118.19s/it]Epoch 16, Training loss: 0.0328, Validation loss: 4.7210, Validation Accuracy: 0.2155
  2%|▏         | 16/1000 [31:34<32:17:47, 118.16s/it]Epoch 17, Training loss: 0.0316, Validation loss: 5.0300, Validation Accuracy: 0.1806
  2%|▏         | 17/1000 [33:32<32:16:01, 118.17s/it]Epoch 18, Training loss: 0.5825, Validation loss: 4.8006, Validation Accuracy: 0.2027
  2%|▏         | 18/1000 [35:30<32:14:02, 118.17s/it]Epoch 19, Training loss: 0.0327, Validation loss: 4.7444, Validation Accuracy: 0.2200
  2%|▏         | 19/1000 [37:28<32:12:20, 118.19s/it]Epoch 20, Training loss: 0.0101, Validation loss: 4.7843, Validation Accuracy: 0.2234
  2%|▏         | 20/1000 [39:26<32:10:37, 118.20s/it]Epoch 21, Training loss: 0.0116, Validation loss: 4.8678, Validation Accuracy: 0.2193
  2%|▏         | 21/1000 [41:25<32:08:38, 118.20s/it]Epoch 22, Training loss: 0.4930, Validation loss: 4.9174, Validation Accuracy: 0.1997
  2%|▏         | 22/1000 [43:23<32:07:06, 118.23s/it]Epoch 23, Training loss: 0.0441, Validation loss: 4.9616, Validation Accuracy: 0.2187
  2%|▏         | 23/1000 [45:21<32:06:06, 118.29s/it]Epoch 24, Training loss: 0.0101, Validation loss: 4.9401, Validation Accuracy: 0.2274
  2%|▏         | 24/1000 [47:20<32:04:47, 118.33s/it]Epoch 25, Training loss: 0.0148, Validation loss: 5.1062, Validation Accuracy: 0.2128
  2%|▏         | 24/1000 [49:18<33:25:20, 123.28s/it]
[I 2024-03-15 22:40:04,569] Trial 4 finished with value: 3.244622399093239 and parameters: {'learning_rate': 1.5199035244619409e-05, 'weight_decay': 4.1710402064016316e-05}. Best is trial 1 with value: 3.1278475075011043.
Early stopping due to validation loss not improving for 20 epochs
Best trial:
  Value: 3.1278475075011043
  Params: 
    learning_rate: 2.100005732309447e-05
    weight_decay: 4.120128539938435e-06
-----completing training in 24498.06 seconds-----
